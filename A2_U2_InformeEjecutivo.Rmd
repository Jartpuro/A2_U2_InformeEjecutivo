---
title: "A2_U2_InformeEjecutivo"
author: "Jhon Alexander Rojas Tavera"
date: "2024-03-09"
output: 
  html_document:
    toc: yes
    toc_float: yes
  pdf_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r , include=FALSE, message=FALSE, echo=FALSE, warning=FALSE}

options(repos = "https://cloud.r-project.org/")
#install.packages("devtools") # solo la primera vez
devtools::install_github("dgonxalex80/paqueteMODELOS", force =TRUE)
library(paqueteMODELOS)
library(knitr)
library(devtools)
data("vivienda")
```

<h1>Caso C&A</h1>

<h2>Enunciado</h2>


Maria comenzó como agente de bienes raíces en Cali hace 10 años. Después de laborar dos años para una empresa nacional, se traslado a Bogotá y trabajó para otra agencia de bienes raíces. Sus amigos y familiares la convencieron de que con su experiencia y conocimientos del negocio debía abrir su propia agencia. Terminó por adquirir la licencia de intermediario y al poco tiempo fundó su propia compañía, C&A (Casas y Apartamentos) en Cali. Santiago y Lina, dos vendedores de la empresa anterior aceptaron trabajar en la nueva compaña. En la actualidad ocho agentes de bienes raíces colaboran con ella en C&A.


Actualmente las ventas de bienes raíces en Cali se han visto disminuidas de manera significativa en lo corrido del año. Durante este periodo muchas instituciones bancarias de ahorro y vivienda están prestando grandes sumas de dinero para la industria y la construcción comercial y residencial. Cuando el efecto producto de las tensiones políticas y sociales disminuya, se espera que la actividad económica de este sector se reactive.


Hace dos días, María recibió una carta solicitando asesoría para la compra de dos viviendas por parte de una compañía internacional que desea ubicar a dos de sus empleados con sus familias en la ciudad. Las solicitudes incluyen las siguientes condiciones:


![Condiciones](C:\Users\jartp\Desktop\Informe_Ejecutivo_A2U2\condiciones.png)

<b>Pasos requeridos para la obtención de los resultados</b>


<ol>
<li>
Realice un filtro a la base de datos e incluya solo las ofertas de : base1: casas, de la zona norte de la ciudad. Presente los primeros 3 registros de las bases y algunas tablas que comprueben la consulta. (Adicional un mapa con los puntos de las bases. Discutir si todos los puntos se ubican en la zona correspondiente o se presentan valores en otras zonas, por que?).</li>

<li>Realice un análisis exploratorio de datos enfocado en la correlación entre la variable respuesta (precio de la casa) en función del área construida, estrato, numero de baños, numero de habitaciones y zona donde se ubica la vivienda. Use gráficos interactivos con el paquete plotly e interprete los resultados.</li>

<li>Estime un modelo de regresión lineal múltiple con las variables del punto anterior (precio = f(área construida, estrato, número de cuartos, número de parqueaderos, número de baños ) ) e interprete los coeficientes si son estadísticamente significativos. Las interpretaciones deber están contextualizadas y discutir si los resultados son lógicos. Adicionalmente interprete el coeficiente R2
 y discuta el ajuste del modelo e implicaciones (que podrían hacer para mejorarlo).</li>

<li>Realice la validación de supuestos del modelo e interprete los resultados (no es necesario corregir en caso de presentar problemas, solo realizar sugerencias de que se podría hacer).</li>

<li>Con el modelo identificado debe predecir el precio de la vivienda con las características de la primera solicitud.</li>

<li>Con las predicciones del modelo sugiera potenciales ofertas que responda a la solicitud de la vivienda 1. Tenga encuentra que la empresa tiene crédito pre-aprobado de máximo 350 millones de pesos. Realice un análisis y presente en un mapa al menos 5 ofertas potenciales que debe discutir.</li>

<li>Realice los pasos del 1 al 6. Para la segunda solicitud que tiene un crédito pre-aprobado por valor de $850 millones.</li>
</ol>


## Exploración inicial de datos

<p>Basándonos en la información proporcionada por el resumen y la estructura del conjunto de datos, podemos hacer varias observaciones significativas. El conjunto de datos consta de 8322 observaciones con 13 variables. Algunas de estas variables tienen valores faltantes, como piso, estrato, preciom, areaconst, parqueaderos, banios, habitaciones, longitud y latitud, lo que sugiere la necesidad de manejar estos valores faltantes antes de realizar análisis posteriores. Las variables zona, piso, tipo y barrio son de naturaleza categórica, mientras que las variables id, estrato, preciom, areaconst, parqueaderos, banios, habitaciones, longitud y latitud son numéricas. Además, la presencia de problemas detectados en los datos sugiere la posibilidad de inconsistencias o errores que deben abordarse durante el análisis. En resumen, este conjunto de datos proporciona una variedad de información sobre propiedades inmobiliarias, incluidos detalles sobre su ubicación, características y precios, pero requerirá un procesamiento cuidadoso para garantizar su validez y utilidad en el análisis posterior.</p>

```{r , warning=FALSE, echo=FALSE, message=FALSE}
summary(vivienda)
str(vivienda)

```
## 1. Realice un filtro a la base de datos 


<h2>Zona Norte</h2>

<p>De acuerdo a la solicitud del informe se presenta a continuación un sub conjunto de datos que permite visualizar el contenido correspondiente al tipo de inmueble casa para la zona norte, en este sentido se destaca lo siguiente:

Las estadísticas descriptivas de las ofertas de casas en la zona norte revelan una amplia gama de características y variabilidad en los datos. Con un total de 722 registros, este conjunto de datos parece haber sido filtrado correctamente para incluir solo las ofertas de casas en la zona norte. Se observa la presencia de valores faltantes en algunos atributos, lo cual es consistente con la estructura original del dataset.

En cuanto a los precios de las casas, se observa una gran variación, con precios que oscilan entre 58 y 1999 unidades monetarias. Tanto la mediana como la media sugieren que la mayoría de las casas tienen precios alrededor de 390 y 445.9 unidades monetarias, respectivamente.

El análisis del área construida revela una diversidad similar, con valores que van desde 30 hasta 1745 metros cuadrados. La mediana y la media indican que la mayoría de las casas tienen un área construida de alrededor de 240 y 264.9 metros cuadrados, respectivamente.

Además de los precios y el área construida, otros atributos como el número de parqueaderos, baños y habitaciones también varían significativamente, con valores máximos de 10 en cada caso. Estos atributos son cruciales para entender las características y comodidades de las casas en la zona norte.</p>
```{r , warning=FALSE, message=FALSE, echo=FALSE}
# Cargar el paquete necesario para visualizar los datos en un mapa
install_leaflet <- capture.output(install.packages("leaflet"), file = NULL)
library(leaflet)



# Cargar el paquete ggplot2 para visualizaciones gráficas
install_ggplot2 <- suppressMessages(install.packages("ggplot2"))
library(ggplot2)

# Filtrar la base de datos para incluir solo las ofertas de casas de la zona norte
casas_zona_norte <- subset(vivienda, tipo == "Casa" & zona == "Zona Norte")

# Mostrar los primeros 3 registros de la base de datos filtrada
cat("Primeros 3 registros de la base de datos filtrada:\n")
kable(head(casas_zona_norte, 3))

# Calcular estadísticas descriptivas
cat("Estadísticas descriptivas de las ofertas de casas en la zona norte:\n")
kable(summary(casas_zona_norte))


```

<p> El gráfico de dispersión indica una fuerte correlación positiva entre el precio y el área construida de las casas en la Zona Norte. El coeficiente de correlación de 0,73 evidencia esta relación directa, donde a mayor área construida, mayor es el precio de la vivienda. La línea de tendencia sugiere un incremento promedio de 1,35 millones de pesos por metro cuadrado adicional. No obstante, la dispersión de los puntos alrededor de la línea de tendencia revela variaciones en el precio influenciadas por otros factores como la ubicación, calidad de construcción, características de la casa y el mercado inmobiliario. Considerar todos estos aspectos es crucial al momento de buscar una vivienda en la Zona Norte.
```{r , warning=FALSE, message=FALSE, echo=FALSE}

# Gráfico de dispersión de precios versus área construida con ggplot2
ggplot(casas_zona_norte, aes(x = areaconst, y = preciom)) +
  geom_point(color = "blue", size = 3) +  # Colores vivos y tamaño de puntos
  geom_smooth(method = "lm", se = FALSE, color = "red") +  # Línea de tendencia
  labs(title = "Precio vs Área Construida - Casas Zona Norte",
       x = "Área Construida", y = "Precio") +
  geom_text(x = max(casas_zona_norte$areaconst), y = max(casas_zona_norte$preciom), 
            label = paste("Correlación:", round(cor(casas_zona_norte$areaconst, casas_zona_norte$preciom), 2)), 
            color = "black", hjust = 1, vjust = 1)



# Instalar y cargar el paquete leaflet.extras
suppressMessages(library(leaflet.extras))
library(leaflet.extras)

# Mapa con los puntos de las bases y botón de reset
mapa_norte <- leaflet(casas_zona_norte) %>%
  addTiles() %>%
  addMarkers(lng = ~longitud, lat = ~latitud, popup = ~barrio) %>%
  addResetMapButton()

mapa_norte  # Mostrar el mapa interactivo



# Tabla de frecuencia de los tipos de vivienda en la zona norte
tipo_counts_norte <- table(casas_zona_norte$tipo)
cat("Tabla de frecuencia de tipos de vivienda en la zona norte:\n")
kable(tipo_counts_norte)

# Tabla de frecuencia de estratos en la zona norte
estrato_counts_norte <- table(casas_zona_norte$estrato)
cat("Tabla de frecuencia de estratos en la zona norte:\n")
kable(estrato_counts_norte)
  


# Tabla de frecuencia de barrios en la zona norte (los 10 primeros)
top_barrios_norte <- head(table(casas_zona_norte$barrio), 10)
top_barrios_df_norte <- as.data.frame(top_barrios_norte)  # Convertir a un dataframe para usar dplyr

# Ordenar la tabla por frecuencia de forma descendente
library(dplyr)
top_barrios_df_norte <- arrange(top_barrios_df_norte, desc(Freq))

# Imprimir la tabla ordenada
cat("Tabla de frecuencia de barrios en la zona norte (ordenada por frecuencia descendente):\n")
kable(top_barrios_df_norte)


```


<h2>Zona Sur</h2>

<p>
Las estadísticas descriptivas de las ofertas de casas en la zona sur muestran una diversidad significativa en los datos. Con un total de 1939 registros, este conjunto de datos parece haber sido filtrado adecuadamente para incluir solo las ofertas de casas en la zona sur. Se observa la presencia de valores faltantes en algunos atributos, lo cual es consistente con la estructura original del dataset.

En relación a los precios de las casas, se evidencia una amplia variación, con valores que oscilan entre 77 y 1900 unidades monetarias. Tanto la mediana como la media sugieren que la mayoría de las casas tienen precios alrededor de 480 y 612.3 unidades monetarias, respectivamente.

El análisis del área construida también revela una diversidad similar, con valores que van desde 48 hasta 1600 metros cuadrados. La mediana y la media indican que la mayoría de las casas tienen un área construida de alrededor de 247 y 282.3 metros cuadrados, respectivamente.

Además de los precios y el área construida, otros atributos como el número de parqueaderos, baños y habitaciones también varían significativamente, con valores máximos de 10 en cada caso. Estos atributos son cruciales para comprender las características y comodidades de las casas en la zona sur.</p>


```{r , warning=FALSE, message=FALSE, echo=FALSE}

# Cargar el paquete necesario para visualizar los datos en un mapa
install_leaflet <- capture.output(install.packages("leaflet"), file = NULL)
library(leaflet)



# Cargar el paquete ggplot2 para visualizaciones gráficas
install_ggplot2 <- suppressMessages(install.packages("ggplot2"))
library(ggplot2)

# Filtrar la base de datos para incluir solo las ofertas de casas de la zona norte
casas_zona_sur <- subset(vivienda, tipo == "Casa" & zona == "Zona Sur")

# Mostrar los primeros 3 registros de la base de datos filtrada
cat("Primeros 3 registros de la base de datos filtrada:\n")
kable(head(casas_zona_sur, 3))

# Calcular estadísticas descriptivas
cat("Estadísticas descriptivas de las ofertas de casas en la zona sur:\n")
kable(summary(casas_zona_sur))



```


<p>
El gráfico de dispersión para la Zona Sur presenta un coeficiente de correlación de 0.67, lo que indica una fuerte correlación positiva entre el precio y el área construida. Esto significa que existe una relación directa entre ambas variables: a mayor área construida, mayor es el precio de la vivienda.

La línea de tendencia en el gráfico indica que, en promedio, el precio aumenta en 1.2 millones de pesos por cada metro cuadrado adicional de área construida.

Sin embargo, la dispersión de los puntos alrededor de la línea de tendencia muestra una variación considerable en los precios.
</p>

```{r , warning=FALSE, message=FALSE, echo=FALSE}

# Gráfico de dispersión de precios versus área construida con ggplot2
ggplot(casas_zona_sur, aes(x = areaconst, y = preciom)) +
  geom_point(color = "blue", size = 3) +  # Colores vivos y tamaño de puntos
  geom_smooth(method = "lm", se = FALSE, color = "red") +  # Línea de tendencia
  labs(title = "Precio vs Área Construida - Casas Zona Sur",
       x = "Área Construida", y = "Precio") +
  geom_text(x = max(casas_zona_sur$areaconst), y = max(casas_zona_sur$preciom), 
            label = paste("Correlación:", round(cor(casas_zona_sur$areaconst, casas_zona_sur$preciom), 2)), 
            color = "black", hjust = 1, vjust = 1)


# Instalar y cargar el paquete leaflet.extras
suppressMessages(library(leaflet.extras))
library(leaflet.extras)

# Mapa con los puntos de las bases y botón de reset
mapa_sur <- leaflet(casas_zona_sur) %>%
  addTiles() %>%
  addMarkers(lng = ~longitud, lat = ~latitud, popup = ~barrio) %>%
  addResetMapButton()

mapa_sur  # Mostrar el mapa interactivo



# Tabla de frecuencia de los tipos de vivienda en la zona norte
tipo_counts_sur <- table(casas_zona_sur$tipo)
cat("Tabla de frecuencia de tipos de vivienda en la zona sur:\n")
kable(tipo_counts_sur)

# Tabla de frecuencia de estratos en la zona norte
estrato_counts_sur <- table(casas_zona_sur$estrato)
cat("Tabla de frecuencia de estratos en la zona sur:\n")
kable(estrato_counts_sur)
  


# Tabla de frecuencia de barrios en la zona norte (los 10 primeros)
top_barrios_sur <- head(table(casas_zona_sur$barrio), 10)
top_barrios_df_sur <- as.data.frame(top_barrios_sur)  # Convertir a un dataframe para usar dplyr

# Ordenar la tabla por frecuencia de forma descendente
library(dplyr)
top_barrios_df_sur <- arrange(top_barrios_df_sur, desc(Freq))

# Imprimir la tabla ordenada
cat("Tabla de frecuencia de barrios en la zona sur (ordenada por frecuencia descendente):\n")
kable(top_barrios_df_sur)


```


<h2>Zona Oriente</h2>


<p>
Las estadísticas descriptivas de las ofertas de casas en la zona oriente muestran una distribución similar en los datos. Con un total de 289 registros, se observa una variabilidad notable en los atributos considerados. Al igual que en otras zonas, se encuentran valores faltantes en algunos atributos, lo cual es coherente con la estructura original del dataset.

En cuanto a los precios de las casas, se observa una variación considerable, con valores que van desde 80 hasta 750 unidades monetarias. Tanto la mediana como la media sugieren que la mayoría de las casas tienen precios alrededor de 235 y 244.8 unidades monetarias, respectivamente.

El análisis del área construida también muestra una diversidad significativa, con valores que van desde 40 hasta 1745 metros cuadrados. La mediana y la media indican que la mayoría de las casas tienen un área construida de alrededor de 179 y 213.4 metros cuadrados, respectivamente.

Además de los precios y el área construida, otros atributos como el número de parqueaderos, baños y habitaciones también exhiben variaciones notables, con valores máximos de 10 en cada caso. </p>


```{r , warning=FALSE, message=FALSE, echo=FALSE}

# Cargar el paquete necesario para visualizar los datos en un mapa
install_leaflet <- capture.output(install.packages("leaflet"), file = NULL)
library(leaflet)



# Cargar el paquete ggplot2 para visualizaciones gráficas
install_ggplot2 <- suppressMessages(install.packages("ggplot2"))
library(ggplot2)

# Filtrar la base de datos para incluir solo las ofertas de casas de la zona norte
casas_zona_oriente <- subset(vivienda, tipo == "Casa" & zona == "Zona Oriente")

# Mostrar los primeros 3 registros de la base de datos filtrada
cat("Primeros 3 registros de la base de datos filtrada:\n")
kable(head(casas_zona_oriente, 3))

# Calcular estadísticas descriptivas
cat("Estadísticas descriptivas de las ofertas de casas en la zona Oriente:\n")
kable(summary(casas_zona_oriente))



```




<p>
El análisis del gráfico de dispersión para la Zona Oriente revela una correlación positiva moderada entre el precio y el área construida, con un coeficiente de correlación de 0.41. Si bien existe una relación directa entre ambas variables, la influencia del área construida sobre el precio es menor que en las zonas Norte y Sur. La línea de tendencia indica un aumento promedio de 0.7 millones de pesos por cada metro cuadrado adicional, pero la dispersión significativa de los puntos alrededor de la línea refleja una notable variabilidad en los precios.

Esta variabilidad puede ser explicada por una mayor influencia de otros factores como la ubicación, la calidad de la construcción, las características de la casa y las condiciones del mercado inmobiliario en la Zona Oriente. 

</p>
```{r , warning=FALSE, message=FALSE, echo=FALSE}
# Gráfico de dispersión de precios versus área construida con ggplot2
ggplot(casas_zona_oriente, aes(x = areaconst, y = preciom)) +
  geom_point(color = "blue", size = 3) +  # Colores vivos y tamaño de puntos
  geom_smooth(method = "lm", se = FALSE, color = "red") +  # Línea de tendencia
  labs(title = "Precio vs Área Construida - Casas Zona Oriente",
       x = "Área Construida", y = "Precio") +
  geom_text(x = max(casas_zona_oriente$areaconst), y = max(casas_zona_oriente$preciom), 
            label = paste("Correlación:", round(cor(casas_zona_oriente$areaconst, casas_zona_oriente$preciom), 2)), 
            color = "black", hjust = 1, vjust = 1)




# Instalar y cargar el paquete leaflet.extras
suppressMessages(library(leaflet.extras))
library(leaflet.extras)

# Mapa con los puntos de las bases y botón de reset
mapa_oriente <- leaflet(casas_zona_oriente) %>%
  addTiles() %>%
  addMarkers(lng = ~longitud, lat = ~latitud, popup = ~barrio) %>%
  addResetMapButton()

mapa_oriente  # Mostrar el mapa interactivo



# Tabla de frecuencia de los tipos de vivienda en la zona norte
tipo_counts_oriente <- table(casas_zona_oriente$tipo)
cat("Tabla de frecuencia de tipos de vivienda en la zona oriente:\n")
kable(tipo_counts_oriente)

# Tabla de frecuencia de estratos en la zona norte
estrato_counts_oriente <- table(casas_zona_oriente$estrato)
cat("Tabla de frecuencia de estratos en la zona oriente:\n")
kable(estrato_counts_oriente)
  


# Tabla de frecuencia de barrios en la zona norte (los 10 primeros)
top_barrios_oriente <- head(table(casas_zona_oriente$barrio), 10)
top_barrios_df_oriente <- as.data.frame(top_barrios_oriente)  # Convertir a un dataframe para usar dplyr

# Ordenar la tabla por frecuencia de forma descendente
library(dplyr)
top_barrios_df_oriente <- arrange(top_barrios_df_oriente, desc(Freq))

# Imprimir la tabla ordenada
cat("Tabla de frecuencia de barrios en la zona oriente (ordenada por frecuencia descendente):\n")
kable(top_barrios_df_oriente)


```




<h2>Zona Oeste</h2>


<p>
Las estadísticas descriptivas de las ofertas de casas en la zona oeste reflejan una distribución diversa en los datos. Con un total de 169 registros, se aprecia una variabilidad considerable en los atributos considerados. Al igual que en otras zonas, se identifican valores faltantes en algunos atributos, lo cual es coherente con la estructura original del dataset.

En relación a los precios de las casas, se evidencia una variación amplia, con valores que oscilan entre 135 y 1999 unidades monetarias. Tanto la mediana como la media sugieren que la mayoría de las casas tienen precios alrededor de 680 y 736.4 unidades monetarias, respectivamente.

El análisis del área construida también muestra una diversidad notable, con valores que van desde 55 hasta 1200 metros cuadrados. La mediana y la media indican que la mayoría de las casas tienen un área construida de alrededor de 300 y 343.2 metros cuadrados, respectivamente.
</p>



```{r , warning=FALSE, message=FALSE, echo=FALSE}

# Cargar el paquete necesario para visualizar los datos en un mapa
install_leaflet <- capture.output(install.packages("leaflet"), file = NULL)
library(leaflet)



# Cargar el paquete ggplot2 para visualizaciones gráficas
install_ggplot2 <- suppressMessages(install.packages("ggplot2"))
library(ggplot2)

# Filtrar la base de datos para incluir solo las ofertas de casas de la zona norte
casas_zona_oeste <- subset(vivienda, tipo == "Casa" & zona == "Zona Oeste")

# Mostrar los primeros 3 registros de la base de datos filtrada
cat("Primeros 3 registros de la base de datos filtrada:\n")
kable(head(casas_zona_oeste, 3))

# Calcular estadísticas descriptivas
cat("Estadísticas descriptivas de las ofertas de casas en la zona Oeste:\n")
kable(summary(casas_zona_oeste))



```


<p>
El gráfico de dispersión para la Zona Oeste muestra una correlación positiva moderada entre el precio y el área construida, con un coeficiente de correlación de 0.59. Esto indica una relación directa, pero no determinante, entre ambas variables. La línea de tendencia sugiere un aumento promedio de 0.95 millones de pesos por cada metro cuadrado adicional, pero la considerable dispersión de los puntos alrededor de la línea refleja una variación notable en los precios.

</p>


```{r , warning=FALSE, message=FALSE, echo=FALSE}
# Gráfico de dispersión de precios versus área construida con ggplot2
ggplot(casas_zona_oeste, aes(x = areaconst, y = preciom)) +
  geom_point(color = "blue", size = 3) +  # Colores vivos y tamaño de puntos
  geom_smooth(method = "lm", se = FALSE, color = "red") +  # Línea de tendencia
  labs(title = "Precio vs Área Construida - Casas Zona Oeste",
       x = "Área Construida", y = "Precio") +
  geom_text(x = max(casas_zona_oeste$areaconst), y = max(casas_zona_oeste$preciom), 
            label = paste("Correlación:", round(cor(casas_zona_oeste$areaconst, casas_zona_oeste$preciom), 2)), 
            color = "black", hjust = 1, vjust = 1)



# Instalar y cargar el paquete leaflet.extras
suppressMessages(library(leaflet.extras))
library(leaflet.extras)

# Mapa con los puntos de las bases y botón de reset
mapa_oeste <- leaflet(casas_zona_oeste) %>%
  addTiles() %>%
  addMarkers(lng = ~longitud, lat = ~latitud, popup = ~barrio) %>%
  addResetMapButton()

mapa_oeste  # Mostrar el mapa interactivo



# Tabla de frecuencia de los tipos de vivienda en la zona norte
tipo_counts_oeste <- table(casas_zona_oeste$tipo)
cat("Tabla de frecuencia de tipos de vivienda en la zona Oeste:\n")
kable(tipo_counts_oeste)

# Tabla de frecuencia de estratos en la zona norte
estrato_counts_oeste <- table(casas_zona_oeste$estrato)
cat("Tabla de frecuencia de estratos en la zona Oeste:\n")
kable(estrato_counts_oeste)
  


# Tabla de frecuencia de barrios en la zona norte (los 10 primeros)
top_barrios_oeste <- head(table(casas_zona_oeste$barrio), 10)
top_barrios_df_oeste <- as.data.frame(top_barrios_oeste)  # Convertir a un dataframe para usar dplyr

# Ordenar la tabla por frecuencia de forma descendente
library(dplyr)
top_barrios_df_oeste <- arrange(top_barrios_df_oeste, desc(Freq))

# Imprimir la tabla ordenada
cat("Tabla de frecuencia de barrios en la zona oeste (ordenada por frecuencia descendente):\n")
kable(top_barrios_df_oeste)


```




<h2>Zona Centro</h2>


<p>
Las estadísticas descriptivas de las ofertas de casas en la zona centro revelan una distribución diversificada en los datos. Con un total de 100 registros, se destaca una variabilidad significativa en los atributos considerados. Al igual que en otras zonas, se encuentran valores faltantes en algunos atributos, lo cual es coherente con la estructura original del dataset.

En cuanto a los precios de las casas, se observa una variación considerable, con valores que van desde 148 hasta 1100 unidades monetarias. Tanto la mediana como la media sugieren que la mayoría de las casas tienen precios alrededor de 310 y 339.2 unidades monetarias, respectivamente.

El análisis del área construida también muestra una diversidad significativa, con valores que van desde 74 hasta 750 metros cuadrados. La mediana y la media indican que la mayoría de las casas tienen un área construida de alrededor de 200 y 217.8 metros cuadrados, respectivamente.

</p>
```{r , warning=FALSE, message=FALSE, echo=FALSE}

# Cargar el paquete necesario para visualizar los datos en un mapa
install_leaflet <- capture.output(install.packages("leaflet"), file = NULL)
library(leaflet)



# Cargar el paquete ggplot2 para visualizaciones gráficas
install_ggplot2 <- suppressMessages(install.packages("ggplot2"))
library(ggplot2)

# Filtrar la base de datos para incluir solo las ofertas de casas de la zona norte
casas_zona_centro <- subset(vivienda, tipo == "Casa" & zona == "Zona Centro")

# Mostrar los primeros 3 registros de la base de datos filtrada
cat("Primeros 3 registros de la base de datos filtrada:\n")
kable(head(casas_zona_centro, 3))

# Calcular estadísticas descriptivas
cat("Estadísticas descriptivas de las ofertas de casas en la zona Centro:\n")
kable(summary(casas_zona_centro))



```

<p>
El gráfico de dispersión para la Zona Centro revela una correlación positiva moderada entre el precio y el área construida, con un coeficiente de correlación de 0.53. Si bien existe una relación directa entre ambas variables, la influencia del área construida sobre el precio es menor que en otras zonas. La línea de tendencia indica un aumento promedio de 0.85 millones de pesos por cada metro cuadrado adicional, pero la notable dispersión de los puntos alrededor de la línea refleja una variabilidad considerable en los precios.
</p>



```{r , warning=FALSE, message=FALSE, echo=FALSE}
# Gráfico de dispersión de precios versus área construida con ggplot2
ggplot(casas_zona_centro, aes(x = areaconst, y = preciom)) +
  geom_point(color = "blue", size = 3) +  # Colores vivos y tamaño de puntos
  geom_smooth(method = "lm", se = FALSE, color = "red") +  # Línea de tendencia
  labs(title = "Precio vs Área Construida - Casas Zona Centro",
       x = "Área Construida", y = "Precio") +
  geom_text(x = max(casas_zona_centro$areaconst), y = max(casas_zona_centro$preciom), 
            label = paste("Correlación:", round(cor(casas_zona_centro$areaconst, casas_zona_centro$preciom), 2)), 
            color = "black", hjust = 1, vjust = 1)



# Instalar y cargar el paquete leaflet.extras
suppressMessages(library(leaflet.extras))
library(leaflet.extras)

# Mapa con los puntos de las bases y botón de reset
mapa_centro <- leaflet(casas_zona_centro) %>%
  addTiles() %>%
  addMarkers(lng = ~longitud, lat = ~latitud, popup = ~barrio) %>%
  addResetMapButton()

mapa_centro  # Mostrar el mapa interactivo



# Tabla de frecuencia de los tipos de vivienda en la zona norte
tipo_counts_centro <- table(casas_zona_centro$tipo)
cat("Tabla de frecuencia de tipos de vivienda en la zona Centro:\n")
kable(tipo_counts_centro)

# Tabla de frecuencia de estratos en la zona norte
estrato_counts_centro <- table(casas_zona_centro$estrato)
cat("Tabla de frecuencia de estratos en la zona Centro:\n")
kable(estrato_counts_centro)
  


# Tabla de frecuencia de barrios en la zona norte (los 10 primeros)
top_barrios_centro <- head(table(casas_zona_centro$barrio), 10)
top_barrios_df_centro <- as.data.frame(top_barrios_centro)  # Convertir a un dataframe para usar dplyr

# Ordenar la tabla por frecuencia de forma descendente
library(dplyr)
top_barrios_df_centro <- arrange(top_barrios_df_centro, desc(Freq))

# Imprimir la tabla ordenada
cat("Tabla de frecuencia de barrios en la zona oriente (ordenada por frecuencia descendente):\n")
kable(top_barrios_df_centro)


```






```{r , warning=FALSE, message=FALSE, echo=FALSE}
library(leaflet)

# Combinar datos de trinchetas de todas las zonas en un único conjunto de datos
todas_trinchetas <- rbind(casas_zona_norte, casas_zona_sur, casas_zona_oriente, casas_zona_oeste, casas_zona_centro)

# Crear un mapa Leaflet
mapa <- leaflet(data = todas_trinchetas) %>%
  addTiles()  # Añadir el fondo de mapa base

# Asignar colores a las trinchetas según la zona
mapa <- mapa %>%
  addCircleMarkers(
    color = ~case_when(
      zona == "norte" ~ "blue",
      zona == "sur" ~ "green",
      zona == "oriente" ~ "yellow",
      zona == "oeste" ~ "orange",
      zona == "centro" ~ "red"
    ),
    radius = 5,  # Tamaño de los marcadores
    fillOpacity = 0.8,  # Opacidad de relleno
    popup = ~paste("Zona:", zona),  # Contenido del popup
    label = ~paste("Precio:", preciom, "<br>Área Construida:", areaconst)  # Contenido de la etiqueta
  )

# Mostrar el mapa
mapa

```